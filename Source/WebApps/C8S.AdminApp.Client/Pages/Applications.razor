@page "/applications"
@using C8S.Domain.Enums
@using SC.Common
@using SC.Common.Models
@inherits BaseRazorPage
@rendermode InteractiveWebAssembly
   
<RadzenStack Orientation="Orientation.Vertical"
             AlignItems="AlignItems.Stretch"
             JustifyContent="JustifyContent.Stretch"
             class="h-100">

    <RadzenStack Orientation="Orientation.Horizontal"
                 AlignItems="AlignItems.Center"
                 JustifyContent="JustifyContent.SpaceBetween"
                 class="flex-shrink-0">

        <RadzenText TagName="TagName.H3"
                    TextStyle="TextStyle.DisplayH3">
            Applications: @(_totalCount?.ToString("(#,##0)") ?? SoftCrowConstants.Display.NotSet)
        </RadzenText>
        
        <RadzenStack Orientation="Orientation.Horizontal"
                     AlignItems="AlignItems.Center"
                     JustifyContent="JustifyContent.SpaceBetween"
                     Gap="0.25rem">
            <RadzenTextBox @bind-Value="@_sortDescription" />
            
            <RadzenDropDown @ref="@_statusDropDown" 
                            @bind-Value="@_selectedStatuses"
                            Data="EnumLabel<ApplicationStatus>.GetAllEnumLabels()"
                            TextProperty="@nameof(EnumLabel<ApplicationStatus>.Display)"
                            ValueProperty="@nameof(EnumLabel<ApplicationStatus>.Value)"
                            Placeholder="Filter by Status"
                            Multiple="true"
                            AllowClear="true"
                            Chips="true"
                            Change="@(async (a) => await HandleStatusDropdownChange(a))" />
        </RadzenStack>

        <IconButton ButtonType="ButtonType.Button"
                    ButtonStyle="ButtonStyle.Primary"
                    IconString="@C8SConstants.Icons.Refresh"
                    Text="Refresh"
                    Click="@(async () => await _applicationsLister.Reload())"/>

    </RadzenStack>
    <ApplicationsLister @ref="_applicationsLister"
                        SortDescription="@_sortDescription"
                        Statuses="@_selectedStatuses"
                        TotalCountChanged="@((int c) => _totalCount = c)"
                        ExceptionRaised="@(async (ex) => await HandleExceptionRaisedAsync(ex))"
                        CssClass="flex-grow-1"/>
</RadzenStack>


<RadzenDialog />
<RadzenNotification />
<RadzenContextMenu />
<RadzenTooltip />